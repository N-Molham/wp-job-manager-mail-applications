/**
 * Created by Nabeel on 2016-02-02.
 */
!function(a,b,c){b(function(){b("#the-list").find("a.button.icon-mail-application").each(function(a,c){b(this).webuiPopover({url:c.hash,dismissible:!1})}),b(".wpjm-ma-mail-application").each(function(){var a=b(this),c=a.find("select").select2({width:"100%",tags:!0});a.on("click","button.button-primary",function(a){var d=b(a.currentTarget),e=b.map(c.select2("data"),function(a){return a.text});if(!e.length)return!0;var f=b.extend({},d.data(),{recipients:e});d.prop("disabled",!0).addClass("loading"),b.post(ajaxurl,f,function(a){a.success?(b(".wpjm-ma-mail-application").find("select").html(a.data.new_list.map(function(a){return'<option value="'+a+'">'+a+"</option>"}).join("")).trigger("change"),alert(a.data.message)):alert(a.data)}).always(function(){d.prop("disabled",!1).removeClass("loading")})})})})}(window,jQuery);